jQuery(function(a){a(document).ready(function(){a(".calculadora-form").each(function(){var c=a(this),d=(c.find(".btn-submit"),c.attr("data-ajax-url"));a(".btn-submit").click(function(e){e.preventDefault(),a(".calculadora-consumo-overlay").show();var f=c.find("#peso").val(),g={action:"calc_agua_response",peso:f};a.ajax({type:"POST",url:d,data:g,dataType:"json"}).done(function(c){"success"===c.status?(a("#consumo-mensal-total").val(c.consumo_mensal).change(),a("#consumo-mensal-exibicao").text(c.consumo_mensal_em_lt_exibicao).change(),b(),a(".calculadora-form").hide(),a(".lista-produtos").show()):(console.log("Status: "+c.status),console.log("Erro: "+c.msg_error))}).fail(function(a,b,c){console.log("xhr: "+a),console.log("status: "+b),console.log("error: "+c)}).always(function(){a(".calculadora-consumo-overlay").fadeOut()})})});var b=function(){var b=Number(a("#consumo-mensal-total").val());if(b){var c=0;a(".lista-produtos").find(".lista-produtos-item").each(function(){var e=a(this),f=Number(e.attr("data-ml")),g=f/b*100,h=Number(e.find(".qty").val()),i=f*h;g=d(g),e.find(".porcentagem-ml").html(g),c+=i}),c=c/b*100,a("#consumo-preenchido").val(c).change()}},c=function(){a(".input-text.qty.text").change(function(c){var e=a(this),f=Number(e.val()),g=e.closest(".lista-produtos-item"),h=g.attr("data-cart-item-key");if(0!==f||h){var i=a(".calculadora-form").attr("data-ajax-url"),j=g.attr("data-prod-id"),k=Number(a("#consumo-preenchido").val()),l=Number(e.prev(".porcentagem-consumo-mensal").find(".porcentagem-consumo-mensal-valor").text());k+=l,k=d(k),a(".consumo-preenchido").text(k),a(".calculadora-consumo-overlay").show();var m={action:"update_cart_calculo",post_id:j,qty:f,cart_item_key:h};a.ajax({type:"POST",url:i,data:m,dataType:"json"}).done(function(c){"success"===c.status?(0===Number(c.qty)?g.removeAttr("data-cart-item-key"):c.add_to_cart&&g.attr("data-cart-item-key",c.add_to_cart),b(),a(document.body).trigger("wc_fragment_refresh")):console.log("Erro: "+c.message)}).fail(function(a,b,c){console.log("xhr: "+a),console.log("status: "+b),console.log("error: "+c)}).always(function(){a(".calculadora-consumo-overlay").fadeOut()})}})},d=function(a){return Math.round(10*a)/10},e=function(){a("#consumo-preenchido").change(function(){var b=a(this).val(),c=d(b);a(".consumo-preenchido").text(String(c).replace(".",",")),b>=100?(a(".calculo-mensagem-alerta").hide(),a(".calculo-mensagem-ok").show(),a("html, body").animate({scrollTop:a("#btn-finaliza-calculo").offset().top},2e3)):(a(".calculo-mensagem-ok").hide(),a(".calculo-mensagem-alerta").show())})},f=function(){a(" .recalcular-btn").click(function(b){b.preventDefault(),a(".lista-produtos").hide(),a(".calculadora-form").show()})};c(),e(),f()})});var remove_produto_do_carrinho=function(a){if(jQuery(".lista-produtos").length>0){var b=(jQuery(a).attr("data-cart_item_key"),jQuery(a).attr("data-product_id"));jQuery("#produto-"+b).find(".qty").val(0).change()}};